@let v = vm(); @if (v.loading) {
<section class="event-details-section">
  <div class="container">
    <h2 class="section-title">Wczytywanie…</h2>

    <div class="event-image-wrapper">
      <div class="skeleton-cover skeleton-box" aria-hidden="true"></div>
    </div>

    <div class="skeleton-table" role="status" aria-label="Ładowanie szczegółów">
      @for (i of [0,1,2,3,4]; track i) {
      <div class="skeleton-row">
        <span class="skeleton-cell skeleton-box"></span>
        <span class="skeleton-cell skeleton-box"></span>
      </div>
      }
    </div>
  </div>
</section>
} @else if (v.error) {
<ngb-alert type="danger">{{ v.error }}</ngb-alert>
} @else if (v.event) {
<section class="event-details-section">
  <div class="container">
    <h2 class="section-title text-center">{{ v.event.name }}</h2>

    @if (v.event.singleDate && v.isArchive) {
    <ngb-alert type="danger" class="w-100 text-center">
      UWAGA! Wydarzenie archiwalne!
    </ngb-alert>
    }

    <div class="event-image-wrapper">
      @if (v.cover.hasImage) {
      <img
        class="event-image"
        [src]="v.cover.src"
        [srcset]="v.cover.srcset!"
        [sizes]="v.cover.sizesAttr!"
        [alt]="v.cover.alt"
        loading="lazy"
        decoding="async"
      />
      } @else {
      <img
        class="event-image"
        [src]="v.cover.src"
        [alt]="v.cover.alt || 'Brak okładki'"
        loading="lazy"
        decoding="async"
      />
      }
    </div>

    @if (v.chips.length) {
    <div class="tag-badges chip-row">
      @for (c of v.chips; track c.key) {
      <span class="tag-badge {{ c.cssClass }}">{{ c.label }}</span>
      }
    </div>
    }

    <div class="event-description">
      @let paragraphs = (v.event.longDescription).split('\n'); @for (paragraph
      of paragraphs; let i = $index; track i) { @if (paragraph.trim().length) {
      <p class="event-paragraph">{{ paragraph }}</p>
      } }
    </div>

    @if (v.event && hasOccurrence()) {
    <app-event-hosts-list [eventId]="eventId()!" [dateIso]="occurrenceDate()!">
    </app-event-hosts-list>
    }

    <table class="table table-dark-style align-middle font-size-small">
      <tbody>
        <tr>
          <th scope="row">
            {{ v.event.recurrence ? "Następna data:" : "Data spotkania:" }}
          </th>
          <td>
            @if (v.event.singleDate) {
            {{ v.event.singleDate | date : "dd.MM.yyyy" }}
            } @else { - }
          </td>
        </tr>

        <tr>
          <th scope="row">Godziny:</th>
          <td>{{ v.timeRangeLabel }}</td>
        </tr>

        <tr>
          <th scope="row">Link do wydarzenia:</th>
          <td>
            @if (v.event.facebookLink) {
            <button
              class="btn btn-info btn-sm"
              (click)="openFacebook(v.event.facebookLink!)"
            >
              Zobacz na Facebooku
            </button>
            } @else {
            <span>Brak wydarzenia</span>
            }
          </td>
        </tr>

        @if (v.chips.length) {
        <tr>
          <th scope="row" class="td-40">Tagi:</th>
          <td class="td-60">
            <div class="tag-badges">
              @for (c of v.chips; track c.key) {
              <span class="tag-badge {{ c.cssClass }}">{{ c.label }}</span>
              }
            </div>
          </td>
        </tr>
        } @if (v.event.rooms.length) {
        <tr>
          <th scope="row" class="td-40">Salki:</th>
          <td class="td-60">
            <div class="rooms-grid">
              @for (room of v.event.rooms; track room) {
              <span class="tag-badge muted room-badge">{{ room }}</span>
              }
            </div>
          </td>
        </tr>
        }
      </tbody>
    </table>
  </div>
</section>
}
